"use strict";var sdmp=Object.assign({},tt),sdmp_info={storageName:"sensorsdata2015_tt",lib_name:"BytedanceMini",lib_method:"code",select_utm:!0,data_is_store:"sensors_prepare_data"};sdmp.sdmp_request=tt.request,sdmp.sdmp_getSystemInfo=tt.getSystemInfo,sdmp.sdmp_getNetworkType=tt.getNetworkType,sdmp.sdmp_getStorageSync=tt.getStorageSync,sdmp.sdmp_setStorageSync=tt.setStorageSync,sdmp.sdmp_getStorage=tt.getStorage;const sa={lib_version:"0.14.4",is_first_launch:!1,_queue:[],getSystemInfoComplete:!1,para:{name:"sensors",server_url:"",max_string_length:500,autoTrack:{appLaunch:!0,appShow:!0,appHide:!0,pageShow:!0,mpClick:!0},show_log:!1,batch_send:!0},log:function(){if(sa.para.show_log)try{return console.log.apply(console,arguments)}catch(e){console.log(arguments[0])}}},_={};var ArrayProto=Array.prototype,ObjProto=Object.prototype,slice=ArrayProto.slice,toString=ObjProto.toString,hasOwnProperty=ObjProto.hasOwnProperty,nativeForEach=ArrayProto.forEach,nativeIndexOf=ArrayProto.indexOf,nativeIsArray=Array.isArray,breaker={},each=_.each=function(e,t,r){if(null==e)return!1;if(nativeForEach&&e.forEach===nativeForEach)e.forEach(t,r);else if(e.length===+e.length){for(var a=0,s=e.length;a<s;a++)if(a in e&&t.call(r,e[a],a,e)===breaker)return!1}else for(var n in e)if(hasOwnProperty.call(e,n)&&t.call(r,e[n],n,e)===breaker)return!1};_.extend=function(e){return each(slice.call(arguments,1),function(t){for(var r in t)void 0!==t[r]&&(e[r]=t[r])}),e},_.extend2Lev=function(e){return each(slice.call(arguments,1),function(t){for(var r in t)void 0!==t[r]&&(_.isObject(t[r])&&_.isObject(e[r])?_.extend(e[r],t[r]):e[r]=t[r])}),e},_.coverExtend=function(e){return each(slice.call(arguments,1),function(t){for(var r in t)void 0!==t[r]&&void 0===e[r]&&(e[r]=t[r])}),e},_.isArray=nativeIsArray||function(e){return"[object Array]"===toString.call(e)},_.isFunction=function(e){try{return/^\s*\bfunction\b/.test(e)}catch(e){return!1}},_.isArguments=function(e){return!(!e||!hasOwnProperty.call(e,"callee"))},_.toArray=function(e){return e?e.toArray?e.toArray():_.isArray(e)?slice.call(e):_.isArguments(e)?slice.call(e):_.values(e):[]},_.values=function(e){var t=[];return null==e?t:(each(e,function(e){t[t.length]=e}),t)},_.include=function(e,t){var r=!1;return null==e?r:nativeIndexOf&&e.indexOf===nativeIndexOf?-1!=e.indexOf(t):(each(e,function(e){if(r||(r=e===t))return breaker}),r)},_.trim=function(e){return e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")},_.isObject=function(e){return"[object Object]"==toString.call(e)&&null!=e},_.isEmptyObject=function(e){if(_.isObject(e)){for(var t in e)if(hasOwnProperty.call(e,t))return!1;return!0}return!1},_.isUndefined=function(e){return void 0===e},_.isString=function(e){return"[object String]"==toString.call(e)},_.isDate=function(e){return"[object Date]"==toString.call(e)},_.isBoolean=function(e){return"[object Boolean]"==toString.call(e)},_.isNumber=function(e){return"[object Number]"==toString.call(e)&&/[\d\.]+/.test(String(e))},_.isJSONString=function(e){try{JSON.parse(e)}catch(e){return!1}return!0},_.decodeURIComponent=function(e){var t="";try{t=decodeURIComponent(e)}catch(r){t=e}return t},_.encodeDates=function(e){return _.each(e,function(t,r){_.isDate(t)?e[r]=_.formatDate(t):_.isObject(t)&&(e[r]=_.encodeDates(t))}),e},_.formatDate=function(e){function t(e){return e<10?"0"+e:e}return e.getFullYear()+"-"+t(e.getMonth()+1)+"-"+t(e.getDate())+" "+t(e.getHours())+":"+t(e.getMinutes())+":"+t(e.getSeconds())+"."+t(e.getMilliseconds())},_.searchObjDate=function(e){_.isObject(e)&&_.each(e,function(t,r){_.isObject(t)?_.searchObjDate(e[r]):_.isDate(t)&&(e[r]=_.formatDate(t))})},_.searchObjString=function(e){_.isObject(e)&&_.each(e,function(t,r){_.isObject(t)?_.searchObjString(e[r]):_.isString(t)&&(e[r]=_.formatString(t))})},_.unique=function(e){for(var t,r=[],a={},s=0;s<e.length;s++)(t=e[s])in a||(a[t]=!0,r.push(t));return r},_.strip_sa_properties=function(e){return _.isObject(e)?(_.each(e,function(t,r){if(_.isArray(t)){var a=[];_.each(t,function(e){_.isString(e)?a.push(e):sa.log("\u60a8\u7684\u6570\u636e-",t,"\u7684\u6570\u7ec4\u91cc\u7684\u503c\u5fc5\u987b\u662f\u5b57\u7b26\u4e32,\u5df2\u7ecf\u5c06\u5176\u5220\u9664")}),0!==a.length?e[r]=a:(delete e[r],sa.log("\u5df2\u7ecf\u5220\u9664\u7a7a\u7684\u6570\u7ec4"))}_.isString(t)||_.isNumber(t)||_.isDate(t)||_.isBoolean(t)||_.isArray(t)||(sa.log("\u60a8\u7684\u6570\u636e-",t,"-\u683c\u5f0f\u4e0d\u6ee1\u8db3\u8981\u6c42\uff0c\u6211\u4eec\u5df2\u7ecf\u5c06\u5176\u5220\u9664"),delete e[r])}),e):e},_.strip_empty_properties=function(e){var t={};return _.each(e,function(e,r){null!=e&&(t[r]=e)}),t},_.utf8Encode=function(e){var t,r,a,s,n="";for(t=r=0,a=(e=(e+"").replace(/\r\n/g,"\n").replace(/\r/g,"\n")).length,s=0;s<a;s++){var i=e.charCodeAt(s),o=null;i<128?r++:o=i>127&&i<2048?String.fromCharCode(i>>6|192,63&i|128):String.fromCharCode(i>>12|224,i>>6&63|128,63&i|128),null!==o&&(r>t&&(n+=e.substring(t,r)),n+=o,t=r=s+1)}return r>t&&(n+=e.substring(t,e.length)),n},_.base64Encode=function(e){var t,r,a,s,n,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",o=0,c=0,p="",u=[];if(!e)return e;e=_.utf8Encode(e);do{t=(n=e.charCodeAt(o++)<<16|e.charCodeAt(o++)<<8|e.charCodeAt(o++))>>18&63,r=n>>12&63,a=n>>6&63,s=63&n,u[c++]=i.charAt(t)+i.charAt(r)+i.charAt(a)+i.charAt(s)}while(o<e.length);switch(p=u.join(""),e.length%3){case 1:p=p.slice(0,-2)+"==";break;case 2:p=p.slice(0,-1)+"="}return p},sa._=_;var meta={page_queue:[]},source_channel_standard="utm_source utm_medium utm_campaign utm_content utm_term";_.getMPScene=function(e){if("number"==typeof e||"string"==typeof e&&""!==e){switch(sdmp_info.lib_name){case"QQMini":e="qq-"+String(e);break;case"SmartProgram":e="baidu-"+String(e);break;case"BytedanceMini":e="byte-"+String(e)}return e}return"\u672a\u53d6\u5230\u503c"},_.getCurrentPage=function(){var e={};try{var t=getCurrentPages();e=t[t.length-1]}catch(e){sa.log(e)}return e},_.getCurrentPath=function(){var e="\u672a\u53d6\u5230";try{var t=_.getCurrentPage();e=t&&"string"==typeof t.route?t.route:e}catch(e){sa.log(e)}return e},_.getCurrentPageOption=function(){var e={};try{var t=_.getCurrentPage();e=t&&_.isObject(t.options)?t.options:{}}catch(e){sa.log(e)}return e},_.getPath=function(e){return e="string"==typeof e?e.replace(/^\//,""):"\u53d6\u503c\u5f02\u5e38"},_.setUtm=function(e,t){var r={},a=_.getQuery(e),s=_.getUtmFromQuery(a,"$","_"),n=_.getUtmFromQuery(a,"$latest_","_latest_");return r.pre1=s,r.pre2=n,_.extend(t,s),r},_.getQuery=function(e){var t={};for(var r in e&&_.isObject(e.query)&&(t=_.extend(t,e.query)),t)t[r]=_.decodeURIComponent(t[r]);return t},_.getUtmFromQuery=function(e,t,r){if(!_.isObject(e))return{};var a={};for(var s in e)-1!==(" "+source_channel_standard+" ").indexOf(" "+s+" ")&&(a[t+s]=e[s]),_.isArray(sa.para.source_channel)&&_.include(sa.para.source_channel,s)&&(a[r+s]=e[s]);return a},_.formatString=function(e){return e.length>sa.para.max_string_length?(sa.log("\u5b57\u7b26\u4e32\u957f\u5ea6\u8d85\u8fc7\u9650\u5236\uff0c\u5df2\u7ecf\u505a\u622a\u53d6--"+e),e.slice(0,sa.para.max_string_length)):e},_.getAppId=function(){return sdmp.sdmp_getAppId&&sdmp.sdmp_getAppId(),sa.para.appid},_.setUpperCase=function(e){return _.isString(e)?e.toLocaleUpperCase():e},_.info={currentProps:{},properties:{$lib:sdmp_info.lib_name,$lib_version:String(sa.lib_version)},getSystem:function(){var e=this.properties,t=!0;function r(){t&&(t=!0,sdmp.sdmp_getSystemInfo({success:function(t){e.$model=t.model,e.$screen_width=Number(t.screenWidth),e.$screen_height=Number(t.screenHeight),e.$os=function(e){try{var t=e.toLowerCase();return"ios"===t?"iOS":"android"===t?"Android":e}catch(e){sa.log(e)}}(t.platform),e.$os_version=t.system.indexOf(" ")>-1?t.system.split(" ")[1]:t.system,e.$brand=_.setUpperCase(t.brand),e.$manufacturer=t.brand},complete:function(){var t=_.getAppId(),r=(new Date).getTimezoneOffset();t&&(e.$app_id=t),_.isNumber(r)&&(e.$timezone_offset=r),sa.getSystemInfoComplete=!0,sa.checkIsComplete()}}))}sdmp.sdmp_getNetworkType({success:function(t){e.$network_type=_.setUpperCase(t.networkType),r()},complete:function(){r()}})},setStatusComplete:function(){if(sa.getSystemInfoComplete)return!1;sa.getSystemInfoComplete=!0,sa._queue.length>0&&(_.each(sa._queue,function(e){sa.prepareData.apply(sa,Array.prototype.slice.call(e))}),sa._queue=[])}},_.getIsFirstDay=function(){return"object"==typeof sa.store._state&&"number"==typeof sa.store._state.first_visit_day_time&&sa.store._state.first_visit_day_time>(new Date).getTime()},_.spliceQuery=function(e){if(e&&_.isObject(e)&&!_.isEmptyObject(e)){var t=[];return _.each(e,function(e,r){t.push(r+"="+_.decodeURIComponent(e))}),t.join("&")}return""},_.joinUrl=function(e,t){return!!e&&("\u672a\u53d6\u5230"===e||"\u53d6\u503c\u5f02\u5e38"===e?"\u672a\u53d6\u5230":t?e+"?"+t:e)},_.savePage=function(){var e=_.getCurrentPath(),t=_.getCurrentPageOption(),r=_.spliceQuery(t),a=_.joinUrl(e,r);meta.page_queue.length>=2?(meta.page_queue.shift(),meta.page_queue.push({referrer:a})):meta.page_queue.push({referrer:a})},_.getReferrerPage=function(){var e={referrer:"\u76f4\u63a5\u6253\u5f00"};return meta.page_queue.length>=2&&(e=meta.page_queue[0]),e},_.getAppProps=function(e){var t={$referrer:"\u76f4\u63a5\u6253\u5f00"};e&&e.path&&(t.$url_path=_.getPath(e.path),t.$url_query=_.spliceQuery(e.query),t.$url=_.joinUrl(t.$url_path,t.$url_query),meta.page_queue.length>0&&(t.$referrer=t.$url));return t},_.getPageProps=function(){var e=_.getCurrentPath(),t=_.getCurrentPageOption(),r=_.spliceQuery(t);return{$url_path:e,$url:_.joinUrl(e,r),$url_query:r,$referrer:_.getReferrerPage().referrer}};let store={getUUID:function(){return Date.now()+"-"+Math.floor(1e7*Math.random())+"-"+Math.random().toString(16).replace(".","")+"-"+String(31242*Math.random()).replace(".","").slice(0,8)},setStorage:function(){},getStorage:function(){return sdmp.sdmp_getStorageSync(sdmp_info.storageName)||""},_state:{},mem:{mdata:[],getLength:function(){return this.mdata.length},add:function(e){this.mdata.push(e)},clear:function(e){this.mdata.splice(0,e)}},toState:function(e){"object"==typeof e&&e.distinct_id?this._state=e:this.set("distinct_id",this.getUUID())},getFirstId:function(){return this._state.first_id},getDistinctId:function(){return this._state.distinct_id},getProps:function(){return this._state.props||{}},setProps:function(e,t){var r=this._state.props||{};t?this.set("props",e):(_.extend(r,e),this.set("props",r))},set:function(e,t){var r={};for(var a in"string"==typeof e?r[e]=t:"object"==typeof e&&(r=e),this._state=this._state||{},r)this._state[a]=r[a];this.save()},change:function(e,t){this._state[e]=t},save:function(){sdmp.sdmp_setStorageSync(sdmp_info.storageName,this._state)},init:function(){var e=this.getStorage();if(e)this.toState(e);else{sa.is_first_launch=!0;var t=new Date,r=t.getTime();t.setHours(23),t.setMinutes(59),t.setSeconds(60),sa.setOnceProfile({$first_visit_time:new Date}),this.set({distinct_id:this.getUUID(),first_visit_time:r,first_visit_day_time:t.getTime()})}}};sa.store=store;class SendStrategy{constructor(){this.dataHasSend=!0,this.syncStorage=!1,this.is_first_batch_write=!0,this.failTime=0}init(){var e=this;sdmp.sdmp_getStorage({key:sdmp_info.data_is_store,complete:function(t){var r=t.data&&_.isArray(t.data)?t.data:[];sa.store.mem.mdata=r.concat(sa.store.mem.mdata),e.syncStorage=!0}}),this.batchInterval()}onAppHide(){sa.para.batch_send&&this.batchSend()}send(e){if(!sa.para.server_url)return!1;this.dataHasChange=!0,sa.store.mem.getLength()>=500&&(sa.log("\u6570\u636e\u91cf\u5b58\u50a8\u8fc7\u5927\uff0c\u6709\u5f02\u5e38"),sa.store.mem.mdata.shift()),sa.log(e),sa.store.mem.add(e),sa.store.mem.getLength()>=sa.para.batch_send.max_length&&this.batchSend()}batchWrite(){var e=this;this.dataHasChange&&(this.is_first_batch_write&&(this.is_first_batch_write=!1,setTimeout(function(){e.batchSend()},1e3)),this.syncStorage&&(sdmp.sdmp_setStorageSync(sdmp_info.data_is_store,sa.store.mem.mdata),this.dataHasChange=!1))}batchInterval(){var e=this;!function t(){setTimeout(function(){e.batchSend(),t()},sa.para.batch_send.send_timeout*Math.pow(2,e.failTime))}(),function t(){setTimeout(function(){e.batchWrite(),t()},500)}()}batchSend(){if(this.dataHasSend){var e,t,r=this,a=sa.store.mem.mdata;if(e=a.length>=100?a.slice(0,100):a,t=e.length,_.isArray(e)&&e.length>0){this.dataHasSend=!1;var s=Date.now();e.forEach(function(e){e._flush_time=s}),e=JSON.stringify(e),e="data_list="+encodeURIComponent(_.base64Encode(e)),sdmp.sdmp_request({url:sa.para.server_url,method:"POST",data:e,dataType:"text",success:function(e){r.batchRemove(t)},fail:function(e){r.sendFail()}})}}}batchRemove(e){this.dataHasSend=!0,this.dataHasChange=!0,sa.store.mem.clear(e),this.batchWrite(),this.failTime=0}sendFail(){this.dataHasSend=!0,this.failTime++}}var sendStrategy=new SendStrategy,mpshow_time=null;sa.setPara=function(e){if(sa.para=_.extend2Lev(sa.para,e),_.isObject(sa.para.register)&&_.extend(_.info.properties,sa.para.register),sa.para.name||(sa.para.name="sensors"),sa.para.server_url){var t={send_timeout:6e3,max_length:6};!0===sa.para.batch_send?sa.para.batch_send=_.extend({},t):_.isObject(sa.para.batch_send)?sa.para.batch_send=_.extend({},t,sa.para.batch_send):sa.para.batch_send=!1}else sa.log("\u8bf7\u4f7f\u7528 setPara() \u65b9\u6cd5\u8bbe\u7f6e server_url \u6570\u636e\u63a5\u6536\u5730\u5740,\u8be6\u60c5\u53ef\u67e5\u770bhttps://www.sensorsdata.cn/manual/mp_sdk_new.html#112-%E5%BC%95%E5%85%A5%E5%B9%B6%E9%85%8D%E7%BD%AE%E5%8F%82%E6%95%B0")},sa.getServerUrl=function(){return sa.para.server_url},sa.prepareData=function(e,t){if(!sa.isComplete)return sa._queue.push(arguments),!1;var r={distinct_id:this.store.getDistinctId(),lib:{$lib:sdmp_info.lib_name,$lib_method:sdmp_info.lib_method,$lib_version:String(sa.lib_version)},properties:{}};_.extend(r,e),_.isObject(e.properties)&&!_.isEmptyObject(e.properties)&&_.extend(r.properties,e.properties),e.type&&"profile"===e.type.slice(0,7)||(r._track_id=Number(String(Math.random()).slice(2,5)+String(Math.random()).slice(2,4)+String(Date.now()).slice(-4)),r.properties=_.extend({},_.info.properties,sa.store.getProps(),_.info.currentProps,r.properties),"object"==typeof sa.store._state&&"number"==typeof sa.store._state.first_visit_day_time&&sa.store._state.first_visit_day_time>(new Date).getTime()?r.properties.$is_first_day=!0:r.properties.$is_first_day=!1),r.properties.$time&&_.isDate(r.properties.$time)?(r.time=1*r.properties.$time,delete r.properties.$time):r.time=1*new Date,_.searchObjDate(r),_.searchObjString(r),sa.para.batch_send?sendStrategy.send(r):sa.send(r,t)},sa.setProfile=function(e,t){sa.prepareData({type:"profile_set",properties:e},t)},sa.setOnceProfile=function(e,t){sa.prepareData({type:"profile_set_once",properties:e},t)},sa.track=function(e,t,r){_.isObject(t)&&!_.isEmptyObject(t)||(t={}),t.$referrer||(t=_.extend(t,_.getPageProps())),this.prepareData({type:"track",event:e,properties:t},r)},sa.identify=function(e,t){if("number"==typeof e)e=String(e);else if("string"!=typeof e)return!1;var r=sa.store.getFirstId();!0===t?r?sa.store.set("first_id",e):sa.store.set("distinct_id",e):r?sa.store.change("first_id",e):sa.store.change("distinct_id",e)},sa.trackSignup=function(e,t,r,a){sa.prepareData({original_id:sa.store.getFirstId()||sa.store.getDistinctId(),distinct_id:e,type:"track_signup",event:t,properties:r},a),sa.store.set("distinct_id",e)},sa.registerApp=function(e){_.isObject(e)&&!_.isEmptyObject(e)&&(_.info.currentProps=_.extend(_.info.currentProps,e))},sa.getPresetProperties=function(){if(_.info&&_.info.properties&&_.info.properties.$lib){var e={};_.each(_.info.currentProps,function(t,r){0===r.indexOf("$")&&(e[r]=t)});var t=_.extend(e,{$url_path:_.getCurrentPath(),$is_first_day:_.getIsFirstDay()},_.info.properties);return delete t.$lib,t}return{}},sa.clearAppRegister=function(e){_.isArray(e)&&_.each(_.info.currentProps,function(t,r){_.include(e,r)&&delete _.info.currentProps[r]})},sa.appLaunch=function(e,t,r){t&&_.isObject(t)||(t={});var a={};_.extend(a,_.getAppProps(e));var s=_.setUtm(e,a);sa.is_first_launch?(a.$is_first_time=!0,_.isEmptyObject(s.pre1)||sa.setOnceProfile(s.pre1)):a.$is_first_time=!1,_.isEmptyObject(s.pre2)||sa.registerApp(s.pre2);var n=_.getMPScene(e.scene);n&&(a.$scene=n,sa.registerApp({$latest_scene:a.$scene})),_.extend(a,t),(!r||sa.para.autoTrack&&sa.para.autoTrack.appLaunch)&&sa.track("$MPLaunch",a)},sa.appShow=function(e,t,r){t&&_.isObject(t)||(t={});var a={};_.extend(a,_.getAppProps(e)),mpshow_time=(new Date).getTime();var s=_.setUtm(e,a);_.isEmptyObject(s.pre2)||sa.registerApp(s.pre2);var n=_.getMPScene(e.scene);n&&(a.$scene=n,sa.registerApp({$latest_scene:a.$scene})),_.extend(a,t),(!r||sa.para.autoTrack&&sa.para.autoTrack.appShow)&&sa.track("$MPShow",a)},sa.appHide=function(e,t){e&&_.isObject(e)||(e={});var r=(new Date).getTime(),a={};_.extend(a,_.getPageProps()),mpshow_time&&r-mpshow_time>0&&(r-mpshow_time)/36e5<24&&(a.event_duration=(r-mpshow_time)/1e3),_.extend(a,e),(!t||sa.para.autoTrack&&sa.para.autoTrack.appHide)&&sa.track("$MPHide",a),sendStrategy.onAppHide()},sa.clearAllRegister=function(){sa.store.setProps({},!0)},sa.login=function(e){var t=sa.store.getFirstId(),r=sa.store.getDistinctId();e!==r&&(t?sa.trackSignup(e,"$SignUp"):(sa.store.set("first_id",r),sa.trackSignup(e,"$SignUp")))},sa.logout=function(e){var t=sa.store.getFirstId();t?(sa.store.set("first_id",""),!0===e?sa.store.set("distinct_id",sa.store.getUUID()):sa.store.set("distinct_id",t)):sa.log("\u6ca1\u6709first_id\uff0clogout\u5931\u8d25")},sa.getAnonymousID=function(){if(!_.isEmptyObject(sa.store._state))return sa.store._state.first_id||sa.store._state.distinct_id;sa.log("\u8bf7\u5148\u521d\u59cb\u5316SDK")},sa.checkIsComplete=function(){this.isComplete=!1,this.getSystemInfoComplete&&this.hasInit&&(this.isComplete=!0,sa._queue.length>0&&(_.each(sa._queue,function(e){sa.prepareData.apply(sa,Array.prototype.slice.call(e))}),sa._queue=[]))},sa.init=function(){if(!0===this.hasInit)return!1;this.hasInit=!0,sa.para.batch_send&&sendStrategy.init(),sa.checkIsComplete()},sa.initial=function(){this._.info.getSystem(),this.store.init(),_.isObject(this.para.register)&&(_.info.properties=_.extend(_.info.properties,this.para.register))},sa.send=function(e){var t="";e._nocache=(String(Math.random())+String(Math.random())+String(Math.random())).slice(2,15),sa.log(e),e._flush_time=Date.now(),e=JSON.stringify(e),t=-1!==sa.para.server_url.indexOf("?")?sa.para.server_url+"&data="+encodeURIComponent(_.base64Encode(e)):sa.para.server_url+"?data="+encodeURIComponent(_.base64Encode(e));sdmp.sdmp_request({url:t,dataType:"text",method:"GET"})},sa.quick=function(){var e=arguments[0],t=arguments[1],r=arguments[2],a=_.isObject(r)?r:{};"appLaunch"===e||"appShow"===e?t?sa[e](t,a):sa.log("App\u7684launch\u548cshow\uff0c\u5728sensors.quick\u7b2c\u4e8c\u4e2a\u53c2\u6570\u5fc5\u987b\u4f20\u5165App\u7684options\u53c2\u6570"):"appHide"===e&&(a=_.isObject(t)?t:{},sa[e](a))};{sa.pageShow=function(e,t){var r={};_.savePage(),_.extend(r,_.getPageProps()),_.extend(r,e),(!t||sa.para.autoTrack&&sa.para.autoTrack.pageShow)&&sa.track("$MPViewScreen",r)};var mpHook={data:1,onLoad:1,onShow:1,onReady:1,onHide:1,onUnload:1,onPullDownRefresh:1,onReachBottom:1,onShareAppMessage:1,onPageScroll:1,onResize:1,onTabItemTap:1,onURLQueryChange:1,attached:1,created:1,detached:1,methods:1,properties:1,ready:1,__customConstructor__:1};function clickTrack(e){var t,r={},a={},s=e.currentTarget||{},n=e.target||{};if(_.isObject(sa.para.framework)&&_.isObject(sa.para.framework.taro)&&!sa.para.framework.taro.createApp&&n.id&&s.id&&n.id!==s.id)return!1;var i=s.dataset||{};if(t=e.type,_.extend(r,_.getPageProps()),r.$element_id=s.id,r.$element_type=i.type,r.$element_content=i.content,r.$element_name=i.name,_.isObject(e.event_prop)&&(a=e.event_prop),t&&_.isClick(t)){if(sa.para.preset_events&&sa.para.preset_events.collect_element&&!1===sa.para.preset_events.collect_element(arguments[0]))return!1;r=_.extend(r,a),sa.track("$MPClick",r)}}_.getMethods=function(e){var t=[];for(var r in e)"function"!=typeof e[r]||mpHook[r]||t.push(r);return t},_.isClick=function(e){return!!{tap:1,longpress:1,longtap:1}[e]};var click_proxy=function(e,t){var r=e[t];e[t]=function(){var e=r.apply(this,arguments),t=arguments[0];return _.isObject(t)&&clickTrack(t),e}},oldApp=App,oldPage=Page,oldComponent=Component}App=function(e){var t=e.onShow,r=e.onLaunch,a=e.onHide;e.onLaunch=function(){this[sa.para.name]=sa,r&&r.apply(this,arguments),sa.appLaunch(arguments[0],{},!0)},e.onShow=function(){t&&t.apply(this,arguments),sa.appShow(arguments[0],{},!0)},e.onHide=function(){a&&a.apply(this,arguments),sa.appHide({},!0)},oldApp.apply(this,arguments)},Page=function(e){var t=e.onShow,r=sa.para.autoTrack&&sa.para.autoTrack.mpClick&&_.getMethods(e);if(r)for(let t=0,a=r.length;t<a;t++)click_proxy(e,r[t]);e.onShow=function(){t&&t.apply(this,arguments),sa.pageShow({},!0)},oldPage.apply(this,arguments)},Component=function(e){try{var t=sa.para.autoTrack&&sa.para.autoTrack.mpClick&&_.getMethods(e.methods);if(t)for(let r=0,a=t.length;r<a;r++)click_proxy(e.methods,t[r]);var r=e.methods.onShow;e.methods.onShow=function(){r&&r.apply(this,arguments),sa.pageShow({},!0)},oldComponent.apply(this,arguments)}catch(e){oldComponent.apply(this,arguments)}},sa.initial(),module.exports=sa;